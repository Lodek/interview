{% extends "base/base.html" %}

{% block content %}

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  let area_results = {{area_results | safe}}
  let subarea_results = {{subarea_results | safe}}
  let band_results = {{band_results | safe}}


  google.charts.load('current', {'packages':['corechart', 'table']});
  google.charts.setOnLoadCallback(drawBand);
  google.charts.setOnLoadCallback(drawArea);
  google.charts.setOnLoadCallback(drawSubarea);
  function drawBand() {
      var data = new google.visualization.DataTable();
      data.addColumn('string', 'Band');
      data.addColumn('number', 'Score');
      data.addRows(band_results)

      var options = {
          width: 400,
          height: 240,
          title: 'Band average',
      };

      var chart = new google.visualization.ColumnChart(document.getElementById('band_chart'));
      chart.draw(data, options);

      var table = new google.visualization.Table(document.getElementById('band_table'));
      table.draw(data);
  }

  function drawArea() {
      var data = new google.visualization.DataTable();
      data.addColumn('string', 'Area');
      data.addColumn('number', 'Score');
      data.addRows(area_results)

      var options = {
          width: 400,
          height: 240,
          title: 'Area average',
      };

      var chart = new google.visualization.ColumnChart(document.getElementById('area_chart'));
      chart.draw(data, options);


      var table = new google.visualization.Table(document.getElementById('area_table'));
      table.draw(data);
  }

  function drawSubarea() {
      var data = new google.visualization.DataTable();
      data.addColumn('string', 'Subarea');
      data.addColumn('number', 'Score');
      data.addRows(subarea_results)

      var options = {
          width: 400,
          height: 240,
          title: 'Subarea average',
      };

      var chart = new google.visualization.ColumnChart(document.getElementById('subarea_chart'));
      chart.draw(data, options);
      var table = new google.visualization.Table(document.getElementById('subarea_table'));
      table.draw(data);
  }

</script>

<style>
  .result {
      display: flex;
      flex-direction: column;
      align-items: center;

  }
</style>

<div class="d-flex justify-content-between align-items-center" style="margin: 0px 120px 0px">
  <div>
  <h1>{{interview.candidate.name}}</h1>
  <span class="text-secondary">Position:</span> {{interview.position.name}}<br>
  <span class="text-secondary">Interviewer:</span> {{interview.interviewer}}<br>
  <span class="text-secondary">Date:</span> {{interview.date.date}}
  </div>

  <div class="border rounded-circle d-flex justify-content-center align-items-center" style="text-align: center; vertical-align: middle; height: 70px; width: 70px; background-color: #f7f7f7">
  <h1>
    <span id="result" class="">{{interview.result}}</span>
  </h1>
  </div>

</div>

  {{interview.comments}}

<center>
  <div class="d-flex justify-content-around">

    <div class="result">
      <div id="area_chart"></div>
      <div id="area_table"></div>
    </div>


    <div class="result">
      <div id="subarea_chart"></div>
      <div id="subarea_table"></div>
    </div>


    <div class="result">
      <div id="band_chart"></div>
      <div id="band_table"></div>
    </div>

  </div>


</center>

<script type="text/javascript">
  {
      let elem = document.getElementById("result");
      let result = Number(elem.innerText);
      let resultClass = ""
      if (result < 5)
          resultClass = "text-fail";
      else if
          (5 <= result && result < 7) resultClass = "text-warning";
      else
          resultClass = "text-success";
      elem.classList = [resultClass];
  }
</script>
{% endblock %}
